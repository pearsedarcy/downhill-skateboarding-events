{% load static %}
{% load countries %}
{% load i18n %}

{% block meta_description %}
{% endblock %}

<div class="card bg-base-100 shadow-xl">
    {% if not event.published %}
    <div class="absolute top-2 left-2 z-10">
      <div class="badge badge-warning gap-2">
        <i class="fas fa-eye-slash"></i>
        Unpublished
      </div>
    </div>
    {% endif %}
    <!-- Show if published or if user is organizer -->
    {% if event.published or event.organizer.user == user %}
      <!-- Event card with hover effects -->
      <div class="card bg-base-100 shadow-xl">
        <!-- Unpublished badge -->
        {% if not event.published %}
        <div class="absolute top-2 left-2 z-10">
          <div class="badge badge-warning gap-2">
            <i class="fas fa-eye-slash"></i>
            Unpublished
          </div>
        </div>
        {% endif %}
        
        <!-- Edit button -->
        {% if event.organizer.user == user and event.slug %}
        <div class="absolute top-2 right-2 z-10">
          <a href="{% url 'events:edit_event' event.slug %}" class="btn btn-circle btn-sm btn-secondary" title="Edit Event">
            <i class="fas fa-edit"></i>
          </a>
        </div>
        {% endif %}

        <!-- Event card content -->
        <a href="{% url 'events:event_details' event.slug %}" class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow duration-200" aria-label="View details for {{ event.title }}">
          <figure class="relative aspect-[16/9]">
            {% if event.cover_image %}
              <img src="{{ event.cover_image.url }}" alt="{{ event.title }}" class="w-full h-full object-cover">
            {% else %}
              <img src="{% static 'images/sdh-bg-wpopo-100q.webp' %}" alt="Default Event Image" class="w-full h-full object-cover">
            {% endif %}
          </figure>
          <div class="card-body p-4">
            <div class="flex justify-between items-start gap-2">
              <h2 class="card-title line-clamp-2">{{ event.title }}</h2>
            </div>
            <div class="flex flex-wrap gap-1 mt-2">
              <div class="badge badge-outline">{{ event.event_type }}</div>
              {% if event.league %}
              <div class="badge badge-primary">{{ event.league.name }}</div>
              {% endif %}
            </div>
            <div class="flex items-center gap-2 mt-4 text-sm">
              <i class="fas fa-calendar text-primary"></i>
              <span>{{ event.start_date|date:"M j, Y" }}</span>
              {% if event.end_date and event.end_date != event.start_date %}
                - {{ event.end_date|date:"M j, Y" }}
              {% endif %}
            </div>
            <div class="flex items-center gap-2 text-sm">
              <i class="fas fa-map-marker-alt text-primary"></i>
              <span>{{ event.location.city }}, {{ event.location.country.name }}</span>
            </div>
          </div>
        </a>
      </div>
    {% endif %}
  </div>