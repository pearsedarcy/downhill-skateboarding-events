{% extends "base.html" %}
{% load static %}

{% block title %}{{ profile.get_display_name }}'s Profile - Downhill Skateboarding Events{% endblock %}

{% block meta_description %}
View {{ profile.get_display_name }}'s skateboarding profile. 
{% if profile.bio %}{{ profile.bio|truncatewords:20 }}{% endif %}
{% if profile.get_location_display %} From {{ profile.get_location_display }}.{% endif %}
{% endblock %}

{% block extra_css %}
<style>
    .profile-banner {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        position: relative;
        overflow: hidden;
    }
    
    .profile-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('{% static "images/skateboard-pattern.svg" %}') repeat;
        opacity: 0.1;
        z-index: 1;
    }
    
    .profile-avatar {
        position: relative;
        z-index: 10;
        border: 4px solid white;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    
    .skating-style-badge {
        background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
        color: white;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .skating-style-badge:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
    }
    
    .achievement-item {
        transition: all 0.3s ease;
    }
    
    .achievement-item:hover {
        transform: translateX(4px);
    }
    
    .stat {
        transition: all 0.3s ease;
    }
    
    .stat:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }
    
    .verification-badge {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.7; }
        100% { opacity: 1; }
    }
    
    .profile-section {
        transition: all 0.3s ease;
    }
    
    .profile-section:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .social-link {
        transition: transform 0.2s ease;
    }
    
    .social-link:hover {
        transform: scale(1.1);
    }
    
    .event-card {
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }
    
    .event-card:hover {
        border-color: hsl(var(--p));
        transform: translateY(-4px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
    }
    
    .completion-progress {
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    }
    
    .tab-content {
        min-height: 400px;
    }
    
    .profile-edit-overlay {
        backdrop-filter: blur(5px);
        background: rgba(0, 0, 0, 0.5);
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-base-100">
    <!-- Profile Header Section -->
    <section class="profile-banner relative h-80 sm:h-80 md:h-80 flex items-center pb-2 sm:pb-4 md:pb-8">
        <div class="container mx-auto px-2 sm:px-4 relative z-10">
            <div class="flex flex-col md:flex-row items-center md:items-end gap-2 sm:gap-4 md:gap-6">
                <!-- Avatar -->
                <div class="relative">
                    {% if profile.avatar %}
                        <img src="{{ profile.avatar.url }}" 
                             alt="{{ profile.get_display_name }}'s avatar" 
                             class="profile-avatar w-20 h-20 sm:w-28 sm:h-28 md:w-40 md:h-40 rounded-full object-cover">
                    {% else %}
                        <div class="profile-avatar w-20 h-20 sm:w-28 sm:h-28 md:w-40 md:h-40 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
                            <i class="fas fa-user text-xl sm:text-3xl md:text-5xl text-white"></i>
                        </div>
                    {% endif %}
                    
                    <!-- Verification Badge -->
                    {% if profile.verification_status != 'UNVERIFIED' %}
                        <div class="verification-badge absolute -top-1 -right-1 w-6 h-6 sm:w-8 sm:h-8 bg-success rounded-full flex items-center justify-center border-2 border-white">
                            <i class="fas fa-check text-white text-xs sm:text-sm"></i>
                        </div>
                    {% endif %}
                    
                    <!-- Edit Avatar Button (if owner) -->
                    {% if can_edit %}
                        <button class="absolute bottom-0 right-0 btn btn-xs sm:btn-sm btn-circle btn-primary border-2 border-white" 
                                onclick="document.getElementById('avatar-modal').showModal()">
                            <i class="fas fa-camera text-xs sm:text-sm"></i>
                        </button>
                    {% endif %}
                </div>
                
                <!-- Profile Info -->
                <div class="text-center md:text-left text-white flex-1">
                    <h1 class="text-xl sm:text-2xl  font-bold mb-1 sm:mb-2">
                        {{ profile.get_display_name }}
                        {% if profile.skating_style %}
                            <span class="text-sm sm:text-lg font-normal opacity-90">🛹</span>
                        {% endif %}
                    </h1>
                    <h2 class="text-sm sm:text-lg font-normal opacity-90">
                        {% if profile.show_real_name and profile.get_full_name != profile.get_display_name %}
                            ({{ profile.get_full_name }})
                        {% endif %}
                    </h2>
                    <!-- Location -->
                    {% if profile.get_location_display %}
                        <p class="text-sm sm:text-lg opacity-90 mb-1 sm:mb-2">
                            <i class="fas fa-map-marker-alt mr-1 sm:mr-2"></i>
                            {{ profile.get_location_display }}
                        </p>
                    {% endif %}
                    
                    <!-- Skateboarding Identity -->
                    <div class="flex flex-wrap gap-1 sm:gap-2 justify-center md:justify-start mb-2 sm:mb-4">
                        {% if profile.skating_style %}
                            <span class="skating-style-badge px-2 py-1 rounded-full text-xs sm:text-sm font-semibold">
                                {{ profile.get_skating_style_display }} Skater
                            </span>
                        {% endif %}
                        {% if profile.stance %}
                            <span class="skating-style-badge px-2 py-1 rounded-full text-xs sm:text-sm">
                                {{ profile.get_stance_display }} Stance
                            </span>
                        {% endif %}
                        {% if profile.years_skating %}
                            <span class="skating-style-badge px-2 py-1 rounded-full text-xs sm:text-sm">
                                {{ profile.years_skating }}yr{{ profile.years_skating|pluralize }} exp
                            </span>
                        {% endif %}
                        {% if profile.skill_level %}
                            <span class="skating-style-badge px-2 py-1 rounded-full text-xs sm:text-sm">
                                Level {{ profile.skill_level }}/10
                            </span>
                        {% endif %}
                    </div>
                    
                    <!-- Bio -->
                    {% if profile.bio %}
                        <p class="text-sm sm:text-base opacity-90 max-w-2xl leading-relaxed hidden sm:block">{{ profile.bio }}</p>
                        <p class="text-xs opacity-90 leading-relaxed sm:hidden">{{ profile.bio|truncatewords:15 }}</p>
                    {% else %}
                        <p class="text-xs sm:text-base opacity-70 italic">
                            {% if can_edit %}
                                Add a bio 🎯
                            {% else %}
                                No bio yet
                            {% endif %}
                        </p>
                    {% endif %}
                </div>
                
                <!-- Action Buttons -->
                <div class="flex gap-1 sm:gap-2">
                    {% if can_edit %}
                        <button class="btn btn-xs sm:btn-sm btn-primary" onclick="console.log('Edit button clicked'); const modal = document.getElementById('edit-modal'); console.log('Modal element:', modal); if(modal) modal.showModal(); else console.error('Edit modal not found');">
                            <i class="fas fa-edit mr-1 sm:mr-2 text-xs sm:text-sm"></i>
                            <span class="hidden sm:inline">Edit Profile</span>
                            <span class="sm:hidden">Edit</span>
                        </button>
                    {% else %}
                        <button class="btn btn-xs sm:btn-sm btn-outline btn-primary">
                            <i class="fas fa-user-plus mr-1 sm:mr-2 text-xs sm:text-sm"></i>
                            <span class="hidden sm:inline">Follow</span>
                        </button>
                        <button class="btn btn-xs sm:btn-sm btn-outline btn-primary">
                            <i class="fas fa-envelope mr-1 sm:mr-2 text-xs sm:text-sm"></i>
                            <span class="hidden sm:inline">Message</span>
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>
    
    <!-- Profile Stats -->
    <section class="container mx-auto px-2 sm:px-4 -mt-4 relative z-20">
        <!-- Profile Stats - Skateboard Focus -->
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 lg:gap-4 mb-4 sm:mb-6 lg:mb-8">
            <div class="stat bg-base-200 rounded-lg p-2 sm:p-3 lg:p-4">
                <div class="stat-figure text-primary">
                    <i class="fas fa-crown text-sm sm:text-lg lg:text-xl"></i>
                </div>
                <div class="stat-title text-xs">Events Organized</div>
                <div class="stat-value text-sm sm:text-lg lg:text-xl">{{ skating_stats.events_organized }}</div>
                {% if skating_stats.events_organized > 0 %}
                <div class="stat-desc text-xs hidden sm:block">Building community</div>
                {% endif %}
            </div>
            <div class="stat bg-base-200 rounded-lg p-2 sm:p-3 lg:p-4">
                <div class="stat-figure text-secondary">
                    <i class="fas fa-skating text-sm sm:text-lg lg:text-xl"></i>
                </div>
                <div class="stat-title text-xs">Events Attended</div>
                <div class="stat-value text-sm sm:text-lg lg:text-xl">{{ skating_stats.events_attended }}</div>
                <div class="stat-desc text-xs hidden sm:block">Sessions completed</div>
            </div>
            <div class="stat bg-base-200 rounded-lg p-2 sm:p-3 lg:p-4">
                <div class="stat-figure text-accent">
                    <i class="fas fa-comment-dots text-sm sm:text-lg lg:text-xl"></i>
                </div>
                <div class="stat-title text-xs">Reviews Given</div>
                <div class="stat-value text-sm sm:text-lg lg:text-xl">{{ skating_stats.reviews_given }}</div>
                <div class="stat-desc text-xs hidden sm:block">Helping others</div>
            </div>
            <div class="stat bg-base-200 rounded-lg p-2 sm:p-3 lg:p-4">
                <div class="stat-figure text-warning">
                    <i class="fas fa-star text-sm sm:text-lg lg:text-xl"></i>
                </div>
                <div class="stat-title text-xs">Avg Rating</div>
                <div class="stat-value text-sm sm:text-lg lg:text-xl">
                    {% if skating_stats.avg_rating %}
                        {{ skating_stats.avg_rating|floatformat:1 }}★
                    {% else %}
                        -
                    {% endif %}
                </div>
                {% if skating_stats.avg_rating %}
                <div class="stat-desc text-xs hidden sm:block">Community trust</div>
                {% endif %}
            </div>
        </div>
    </section>
    
    <!-- Profile Content -->
    <section class="container mx-auto px-2 sm:px-4 pb-4 sm:pb-8 lg:pb-12">
        <div class="bg-base-100 rounded-xl sm:rounded-2xl shadow-lg sm:shadow-xl overflow-hidden">
            <!-- Content -->
            <div class="p-3 sm:p-4 lg:p-6 space-y-4 sm:space-y-6 lg:space-y-8">
                <!-- Overview Section -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
                    <!-- Left Column - Profile Details -->
                    <div class="lg:col-span-2 space-y-4 sm:space-y-6">
                        <!-- Skateboarding Setup -->
                        {% if profile.primary_setup or profile.stance or profile.skill_level %}
                            <div class="profile-section card bg-base-100 shadow-lg">
                                <div class="card-body p-3 sm:p-4 lg:p-6">
                                    <h2 class="card-title text-primary text-sm sm:text-base">
                                        <i class="fas fa-skating mr-1 sm:mr-2"></i>
                                        Skateboarding Profile
                                    </h2>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-1 ">
                                        {% if profile.stance %}
                                            <div class="stat p-1 sm:p-1">
                                                <div class="stat-title text-xs">Stance</div>
                                                <div class="stat-value text-sm sm:text-lg">{{ profile.get_stance_display }}</div>
                                            </div>
                                        {% endif %}
                                        {% if profile.skill_level %}
                                            <div class="stat p-1 sm:p-1">
                                                <div class="stat-title text-xs">Skill Level</div>
                                                <div class="stat-value text-sm sm:text-lg">{{ profile.skill_level }}/10</div>
                                            </div>
                                        {% endif %}
                                        {% if profile.years_skating %}
                                            <div class="stat p-1 sm:p-1">
                                                <div class="stat-title text-xs">Years Skating</div>
                                                <div class="stat-value text-sm sm:text-lg">{{ profile.years_skating }}</div>
                                            </div>
                                        {% endif %}
                                    </div>
                                    {% if profile.primary_setup %}
                                        <div class="mt-2 sm:mt-4">
                                            <h3 class="font-semibold mb-1 sm:mb-2 text-sm sm:text-base">Primary Setup</h3>
                                            <p class="text-base-content/80 text-xs sm:text-sm">{{ profile.primary_setup }}</p>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endif %}
                        
                        <!-- Skateboarding Bio & Style -->
                        {% if profile.bio or profile.skating_styles.all %}
                            <div class="profile-section card bg-base-100 shadow-lg">
                                <div class="card-body p-3 sm:p-4 lg:p-6">
                                    <h2 class="card-title text-primary text-sm sm:text-base">
                                        <i class="fas fa-user-circle mr-1 sm:mr-2"></i>
                                        About {{ profile.user.first_name|default:profile.user.username }}
                                    </h2>
                                    
                                    {% if profile.bio %}
                                        <div class="mb-2 sm:mb-4">
                                            <p class="text-base-content leading-relaxed text-xs sm:text-sm">{{ profile.bio }}</p>
                                        </div>
                                    {% endif %}
                                    
                                    {% if profile.skating_styles.all %}
                                        <div class="mt-2 sm:mt-4">
                                            <h3 class="font-semibold mb-2 sm:mb-3 text-sm sm:text-base">Skating Styles</h3>
                                            <div class="flex flex-wrap gap-1 sm:gap-2">
                                                {% for style in profile.skating_styles.all %}
                                                    <span class="skating-style-badge badge badge-sm sm:badge-lg px-2 py-1 sm:px-3 sm:py-2 text-xs sm:text-sm">
                                                        {{ style.name }}
                                                    </span>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endif %}
                        
                        <!-- Current Achievements & Milestones -->
                        {% if skating_stats.events_organized > 0 or skating_stats.events_attended > 5 or skating_stats.avg_rating >= 4.0 %}
                            <div class="profile-section card bg-base-100 shadow-lg">
                                <div class="card-body p-3 sm:p-4 lg:p-6">
                                    <h2 class="card-title text-accent text-sm sm:text-base">
                                        <i class="fas fa-trophy mr-1 sm:mr-2"></i>
                                        Achievements
                                        <span class="badge badge-accent badge-xs sm:badge-sm">
                                            {% if skating_stats.events_organized > 0 %}1{% endif %}
                                            {% if skating_stats.events_attended >= 5 %}{% if skating_stats.events_organized > 0 %}+{% endif %}1{% endif %}
                                            {% if skating_stats.avg_rating >= 4.0 %}{% if skating_stats.events_organized > 0 or skating_stats.events_attended >= 5 %}+{% endif %}1{% endif %}
                                        </span>
                                    </h2>
                                    <div class="space-y-2 sm:space-y-3">
                                        {% if skating_stats.events_organized > 0 %}
                                            <div class="achievement-item flex items-center gap-2 sm:gap-3 p-2 sm:p-3 rounded-lg bg-primary/10 border border-primary/20">
                                                <div class="w-8 h-8 sm:w-10 sm:h-10 bg-primary rounded-full flex items-center justify-center">
                                                    <i class="fas fa-crown text-white text-xs sm:text-sm"></i>
                                                </div>
                                                <div class="flex-1">
                                                    <h3 class="font-semibold text-primary text-xs sm:text-sm">Community Organizer</h3>
                                                    <p class="text-xs sm:text-sm text-base-content/70">Organized {{ skating_stats.events_organized }} event{{ skating_stats.events_organized|pluralize }}</p>
                                                </div>
                                                <div class="badge badge-primary badge-xs sm:badge-sm">🏆</div>
                                            </div>
                                        {% endif %}
                                        
                                        {% if skating_stats.events_attended >= 5 %}
                                            <div class="achievement-item flex items-center gap-2 sm:gap-3 p-2 sm:p-3 rounded-lg bg-secondary/10 border border-secondary/20">
                                                <div class="w-8 h-8 sm:w-10 sm:h-10 bg-secondary rounded-full flex items-center justify-center">
                                                    <i class="fas fa-skating text-white text-xs sm:text-sm"></i>
                                                </div>
                                                <div class="flex-1">
                                                    <h3 class="font-semibold text-secondary text-xs sm:text-sm">Active Skater</h3>
                                                    <p class="text-xs sm:text-sm text-base-content/70">Attended {{ skating_stats.events_attended }} sessions</p>
                                                </div>
                                                <div class="badge badge-secondary badge-xs sm:badge-sm">🛹</div>
                                            </div>
                                        {% endif %}
                                        
                                        {% if skating_stats.avg_rating >= 4.0 %}
                                            <div class="achievement-item flex items-center gap-2 sm:gap-3 p-2 sm:p-3 rounded-lg bg-warning/10 border border-warning/20">
                                                <div class="w-8 h-8 sm:w-10 sm:h-10 bg-warning rounded-full flex items-center justify-center">
                                                    <i class="fas fa-star text-white text-xs sm:text-sm"></i>
                                                </div>
                                                <div class="flex-1">
                                                    <h3 class="font-semibold text-warning text-xs sm:text-sm">Trusted Member</h3>
                                                    <p class="text-xs sm:text-sm text-base-content/70">{{ skating_stats.avg_rating|floatformat:1 }}★ average rating</p>
                                                </div>
                                                <div class="badge badge-warning badge-xs sm:badge-sm">⭐</div>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    
                    <!-- Right Column - Sidebar -->
                    <div class="space-y-4 sm:space-y-6">
                        <!-- Profile Completion -->
                        {% if can_edit and completion_percentage < 100 %}
                            <div class="profile-section card bg-base-100 shadow-lg">
                                <div class="card-body">
                                    <h2 class="card-title text-warning">
                                        <i class="fas fa-chart-line mr-2"></i>
                                        Profile Completion
                                    </h2>
                                    <div class="space-y-4">
                                        <div class="flex items-center justify-between">
                                            <span>{{ completion_percentage }}% Complete</span>
                                            <span class="text-sm text-base-content/70">{{ remaining_percentage }}% to go</span>
                                        </div>
                                        <progress class="progress progress-primary w-full" value="{{ completion_percentage }}" max="100"></progress>
                                        
                                        {% if completion_suggestions %}
                                            <div class="space-y-2">
                                                <h3 class="font-semibold text-sm">Quick wins:</h3>
                                                {% for suggestion in completion_suggestions|slice:":3" %}
                                                    <div class="flex items-center gap-2 text-sm">
                                                        <i class="fas fa-lightbulb text-warning"></i>
                                                        {{ suggestion.message }}
                                                        <span class="badge badge-warning badge-xs">+{{ suggestion.weight }}%</span>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        
                        <!-- Social Links -->
                        {% if social_links %}
                            <div class="profile-section card bg-base-100 shadow-lg">
                                <div class="card-body">
                                    <h2 class="card-title text-info">
                                        <i class="fas fa-share-alt mr-2"></i>
                                        Social Links
                                    </h2>
                                    <div class="space-y-3">
                                        {% for platform, link in social_links.items %}
                                            <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" 
                                               class="social-link flex items-center gap-3 p-3 rounded-lg bg-base-200 hover:bg-base-300 transition-colors">
                                                <i class="{{ link.icon }} text-lg"></i>
                                                <span>{{ link.display }}</span>
                                                <i class="fas fa-external-link-alt ml-auto text-xs opacity-50"></i>
                                            </a>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        
                        <!-- Skater Info -->
                        <div class="profile-section card bg-base-100 shadow-lg">
                            <div class="card-body p-3 sm:p-4 lg:p-6">
                                <h2 class="card-title text-accent text-sm sm:text-base">
                                    <i class="fas fa-info-circle mr-1 sm:mr-2"></i>
                                    Skater Info
                                </h2>
                                <div class="stats stats-vertical">
                                    <div class="stat p-2 sm:p-3">
                                        <div class="stat-title text-xs">Member Since</div>
                                        <div class="stat-value text-sm sm:text-base">{{ profile.created_at|date:"M Y" }}</div>
                                        <div class="stat-desc text-xs hidden sm:block">{{ profile.created_at|timesince }} ago</div>
                                    </div>
                                    
                                    {% if profile.years_skating %}
                                        <div class="stat p-2 sm:p-3">
                                            <div class="stat-title text-xs">Skating Experience</div>
                                            <div class="stat-value text-sm sm:text-base">{{ profile.years_skating }} year{{ profile.years_skating|pluralize }}</div>
                                            <div class="stat-desc text-xs hidden sm:block">On wheels</div>
                                        </div>
                                    {% endif %}
                                    
                                    {% if profile.verification_status != 'UNVERIFIED' %}
                                        <div class="stat p-2 sm:p-3">
                                            <div class="stat-title text-xs">Status</div>
                                            <div class="stat-value text-xs sm:text-base flex items-center gap-1 sm:gap-2">
                                                <i class="fas fa-check-circle text-success text-xs sm:text-sm"></i>
                                                <span class="text-xs sm:text-sm">{{ profile.get_verification_status_display }}</span>
                                            </div>
                                        </div>
                                    {% endif %}
                                    
                                    <div class="stat p-2 sm:p-3">
                                        <div class="stat-title text-xs">Last Active</div>
                                        <div class="stat-value text-sm sm:text-base">{{ profile.updated_at|timesince }} ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Events Section -->
                <div class="divider my-6 sm:my-8 lg:my-12">
                    <h2 class="text-lg sm:text-xl lg:text-2xl font-bold text-primary flex items-center gap-2 sm:gap-3">
                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-primary rounded-lg flex items-center justify-center">
                            <i class="fas fa-calendar text-white text-sm sm:text-base"></i>
                        </div>
                        All Events
                        <span class="text-xs sm:text-sm font-normal text-base-content/60 hidden sm:inline">
                            🛹 Sessions & Competitions
                        </span>
                    </h2>
                </div>
                {% include 'profiles/partials/events_tab.html' %}
                
                <!-- Activity Section -->
                <div class="divider my-6 sm:my-8 lg:my-12">
                    <h2 class="text-lg sm:text-xl lg:text-2xl font-bold text-primary flex items-center gap-2 sm:gap-3">
                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-secondary rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-line text-white text-sm sm:text-base"></i>
                        </div>
                        Activity Timeline
                    </h2>
                    <span class="text-xs sm:text-sm font-normal text-base-content/60 hidden sm:inline">
                        📈 Your Skateboarding Journey
                    </span>
                </div>
                {% include 'profiles/partials/activity_tab.html' %}
                
                <!-- Social Section -->
                {% if profile.get_social_links %}
                    <div class="divider my-6 sm:my-8 lg:my-12">
                        <h2 class="text-lg sm:text-xl lg:text-2xl font-bold text-primary flex items-center gap-2 sm:gap-3">
                            <div class="w-8 h-8 sm:w-10 sm:h-10 bg-info rounded-lg flex items-center justify-center">
                                <i class="fas fa-share-alt text-white text-sm sm:text-base"></i>
                            </div>
                            Social Media
                            <span class="text-xs sm:text-sm font-normal text-base-content/60 hidden sm:inline">
                                🌐 Connect & Follow
                            </span>
                        </h2>
                    </div>
                    {% include 'profiles/partials/social_tab.html' %}
                {% endif %}
                
                <!-- Settings Section -->
                {% if can_edit %}
                    <div class="divider my-6 sm:my-8 lg:my-12">
                        <h2 class="text-lg sm:text-xl lg:text-2xl font-bold text-primary flex items-center gap-2 sm:gap-3">
                            <div class="w-8 h-8 sm:w-10 sm:h-10 bg-accent rounded-lg flex items-center justify-center">
                                <i class="fas fa-cog text-white text-sm sm:text-base"></i>
                            </div>
                            Profile Settings
                            <span class="text-xs sm:text-sm font-normal text-base-content/60 hidden sm:inline">
                                ⚙️ Privacy & Preferences
                            </span>
                        </h2>
                    </div>
                    {% include 'profiles/partials/settings_tab.html' %}
                {% endif %}
            </div>
        </div>
    </section>
</div>

<!-- Modals -->
{% if can_edit %}
    {% include 'profiles/partials/avatar_modal.html' %}
    {% include 'profiles/partials/edit_modal.html' %}
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
// Edit mode functionality
let editMode = false;

function toggleEditMode() {
    editMode = !editMode;
    const editableElements = document.querySelectorAll('[data-editable]');
    
    editableElements.forEach(element => {
        if (editMode) {
            element.classList.add('profile-editable');
            element.title = 'Click to edit';
        } else {
            element.classList.remove('profile-editable');
            element.title = '';
        }
    });
    
    // Show/hide edit overlays
    const editOverlays = document.querySelectorAll('.profile-edit-overlay');
    editOverlays.forEach(overlay => {
        overlay.style.display = editMode ? 'flex' : 'none';
    });
}

// Profile field editing
function editField(fieldName, currentValue) {
    const modal = document.createElement('div');
    modal.className = 'modal modal-open';
    modal.innerHTML = `
        <div class="modal-box">
            <h3 class="font-bold text-lg">Edit ${fieldName.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())}</h3>
            <div class="py-4">
                <label class="label">
                    <span class="label-text">New value:</span>
                </label>
                <input type="text" id="edit-field-input" class="input input-bordered w-full" value="${currentValue}">
            </div>
            <div class="modal-action">
                <button class="btn" onclick="closeEditModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveField('${fieldName}')">Save</button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    document.getElementById('edit-field-input').focus();
}

function saveField(fieldName) {
    const input = document.getElementById('edit-field-input');
    const value = input.value;
    
    fetch('{% url "profiles:update_profile_api" %}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
        },
        body: JSON.stringify({
            field: fieldName,
            value: value
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            location.reload();
        } else {
            alert('Error: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while saving.');
    });
    
    closeEditModal();
}

function closeEditModal() {
    const modals = document.querySelectorAll('.modal');
    modals.forEach(modal => {
        if (modal.classList.contains('modal-open')) {
            modal.remove();
        }
    });
}

// Add smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
</script>
{% endblock %}
